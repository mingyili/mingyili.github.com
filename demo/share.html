<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <meta name="format-detection" content="telephone=no"/>
    <meta http-equiv="x-dns-prefetch-control" content="on"/>

    <link rel="stylesheet" type="text/css" href="css/common.css"/>
    <title>分享1</title>
    <script type="text/javascript">
    /*图片错误*/
    function nofind(str){
        var img = event.srcElement;
        img.src = str || "images/none.png";
        img.onerror = null;
    }
    </script>
    <style>
    /*背景图*/
    body:after {
        background-image: url(images/share_back.png);
        background-color: #fff;
    }
    </style>
</head>
<body>
    <div class="container">
        
        <!-- 分享 -->
        <div class="share_cont">
            
            <div class="user_img rAll">
                <img src="images/1.jpg" class="rAll">
            </div>
            <p class="default t_center notice">
                <span class="flarge">注册领取200元新人红包</span><br/>
                <span class="fbig">邀请好友变身金主，坐等收钱钱</span>
            </p>
            <div class="form_cont">
                <div class="item_cont">
                    <div class="input_cell">
                        <input type="tel" name="phone" placeholder="请输入手机号">
                    </div>
                </div>
                <div class="item_cont">
                    <div class="input_cell">
                        <input type="text" name="code" placeholder="验证码">
                    </div>
                    <div class="item_cell half">
                        <span class="btn btn_big j_send_code">获取验证码</span>
                    </div>
                </div>
                <div class="btn_cont">
                    <button class="btn btn_big j_submit">领取优惠券</button>
                </div>
            </div>

            <div class="info_cont rbig">
                <p class="t_center fbig">活动细则</p>
                <p>1.邀请好友，TA将获得200元新人礼包；</p>
                <p>2.好友兑换礼包：通过您发出的分享邀请，在邀请页面中输入手机号兑换；好友必须是新用户。</p>
                <p>3.好友首次使用礼包成功后，您将获得好友消费金额10%的现金红包。红包即时转入微信零钱，可提现。</p>
                <p>4.非正常途径获得的奖励无效，时尚殿堂保留最终解释权。</p>
            </div>

        </div>
        <!-- 分享 end -->

    </div>
    <!-- container end -->

    <script src="js/zepto.min.js"></script>
    <script src="js/common.js"></script>

    <script type="text/javascript">
        var $phone = $('input[name="phone"]'),
            phone = '',
            $code = $('input[name="code"]');
    	//计时程序
        function time(dom, now) {
            if (now == 0) {
                dom.removeClass("disabled");
                dom.html('发送验证码');
            } else {
                dom.addClass("disabled");
                now--;
                dom.html(now + 's后再发'); //
                setTimeout(function() {
                    time(dom, now);
                }, 1000);
            }
        }

        //发送验证码
        $('.j_send_code').bind('click', function() {
            //验证手机号
            if (!testPhone()) return;
            
            //
            var _this = $(this),
                disabled = _this.hasClass('disabled');
            //开始计时
            if (!disabled) {
                //调用发送程序
                $.successTip("发送成功，请耐心等待");
                _this.addClass('disabled');
                time(_this, 60);
            }
        });

        //手机验证方法
        var parttenphone = /^1[3|4|5|7|8][0-9]\d{8}$/;
        function testPhone(){
            var temphone = $phone.val();

            if(!parttenphone.test(temphone)){
                $.errorTip("请输入正确的联系方式");
                errorInput($phone);
                return false;
            }
            phone = temphone;
            return true;
        }

        $('.j_submit').bind('click', function(){
            testPhone();
            if(!phone) {

                $.errorTip("请输入联系方式");
                errorInput($phone);
                return false;
            } 

            var code = $code.val();
            if(!code) {
                $.errorTip("请输入验证码");
                errorInput($code);
                return false;
            }

            //传 code 判断验证码是否正确

            //执行其他程序
            var _this = $(this);
            $.showLoad('正在领取...');
            _this.text('正在领取...').addClass('disabled');

            setTimeout(function(){
                //领取成功
                $.hideLoad();
                _this.text('领取成功').removeClass('disabled')
                $.showAlert({
                    text: '恭喜你！<br/>成功领取优惠券。',
                    yesText: '查看',
                    onYes: function(){
                        window.location.href = 'user.html';
                    },
                    noText: '取消',
                    onNo: function(){
                        window.location.href = 'user.html';
                    },
                });

            }, 2000);

        });
    </script>
</body>
</html>
