/*!
 * Last Update : 2016-02-25 04:04:09
 */
!function(a){var b=function(b,c){var d={url:"",addCardUrl:"",maxSelectNum:1,defaultId:"",callback:void 0},e=c||b.data("option"),f=this;f.option=a.extend(d,e),f.ele=b.bind("click",function(){f.open()})};b.prototype={build:function(){var b=this,c='<div class="popup"><header class="bar bar-nav"><a class="button button-link button-nav pull-right close-popup"><span class="icon close icon-close"></span></a><h1 class="title">选择银行卡</h1></header><div class="content infinite-scroll" data-toggle="scroller" data-type="js"><div class="content-inner"><div class="cont-margin cont-padded"><div class="list-block list-full media-list list-checklist"></div><div class="mt-big"><a class="button button-big button-noround j-addcard"><i class="icon-add v-2"></i> 添加银行卡</a></div></div></div>';this.popup=a(a.popup(c,!1)),this.popup.one("opened",function(){a.infiniteLoad.reload({page:b.popup,initScroll:!0,url:b.option.url,processList:function(a,c){b.addItems(a,c)}})}),this.popup.on("click",".label-checkbox",function(){var c=a(this),d=c.data("info");b.option.defaultId=d.id,b.option.callback(d),a.closeModal(b.popup)}),this.popup.on("click",".j-addcard",function(){a.closeModal(b.popup),a.router.loadPage(b.option.addCardUrl)})},addItems:function(b,c){var d=this,e="";a.each(b,function(b,f){e=f.id===d.option.defaultId||a.inArray(f.id,d.option.defaultId)>-1?"checked":"";var g=a('<label class="label-checkbox item-content">'),h='<div class="item-media"><img class="inline-img" src="'+API.HOST+'/licai/dist/common/img/bank_zs.png"></div><div class="item-inner"><div class="item-title">招商银行储蓄卡尾号6654</div><div class="item-subtitle">单笔5万/单日50万</div></div><input type="radio" name="bankcards" '+e+' ><div class="item-media"><i class="icon icon-form-checkbox"></i></div>';g.html(h).data("info",f).appendTo(c)})},open:function(){var b=this;b.popup?a.popup(b.popup):b.build()},close:function(){a.closeModal(_this.popup)}},b.init=function(b){var c=this;b&&b.length>0&&b.each(function(){new c(a(this))})},a.selectCard=b,a.selectCard.init(a(".j_selectcard"))}(Zepto);