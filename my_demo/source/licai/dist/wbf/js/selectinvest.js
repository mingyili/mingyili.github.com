/*!
 * Last Update : 2016-02-25 04:04:09
 */
!function(a){var b=function(){this.inited=!1};b.prototype.open=function(b){this.inited?a.popup(this.$plug):this.init(b)},b.prototype.reopen=function(b){var c=this;c.inited?c.$plug[0].id!=b.id?(c.$plug.remove(),c.inited=!1,c.init(b)):a.popup(c.$plug):c.init(b)},b.prototype.init=function(b){function c(b){console.log(b);var c=0,d=b.length;a.each(b,function(a,b){c+=b.money}),j.text(d),k.text(c),c>0?l.removeClass("disabled"):l.addClass("disabled")}var d=this,e={title:"选择提现项目",id:"",url:"",maxSelectNum:1,defaultId:"",calculate:void 0,callback:void 0};for(var f in b)e[f]=b[f];isNaN(e.maxSelectNum)&&(e.maxSelectNum=0),d.opt=e;var g='<div class="popup" id="'+e.id+'"><header class="bar bar-nav"><a class="button button-link button-nav pull-right close-popup"><span class="icon close icon-close"></span></a><h1 class="title">'+e.title+"</h1></header>";1!==e.maxSelectNum&&(g+='<div class="bar bar-standard bar-footer"><div class="list-block media-list"><div class="item-content"><div class="row"><small>已选择 <span class="j-select-num">0</span> 个</small><div class="item-subtitle color-primary">共 <span class="j-select-money">0.00</span> 元</div></div><div class="item-media"><a href="#" class="button button-fill disabled j-select select-button">确定</a></div></div></div></div>'),g+='<div class="content infinite-scroll" data-distance="100" data-toggle="scroller" data-type="js"><div class="content-inner"><div class="list-block media-list list-full select-list"></div></div></div>';var h=a(a.popup(g,!1));if(h.one("opened",function(){d.inited||(a.infiniteLoad.reload({page:h,initScroll:!0,url:e.url,processList:function(a,b){d.addItems(a,b)}}),d.inited=!0)}),d.close=function(){a.closeModal(h)},1===e.maxSelectNum)h.on("click",".label-checkbox",function(){var b=a(this),c=b.data("info");h.find(".label-checkbox.checked").removeClass("checked"),b.addClass("checked"),d.opt.defaultId=c.id,e.callback(c),setTimeout(function(){a.closeModal(h)},100)});else{var i=[],j=h.find(".j-select-num"),k=h.find(".j-select-money"),l=h.find(".j-select");typeof d.opt.defaultId!=typeof[]&&(d.opt.defaultId=[]),h.on("click",".label-checkbox",function(){var b=a(this),f=b.data("info");if(b.hasClass("checked")){var g=a.inArray(f.id,d.opt.defaultId);g>-1&&(i.splice(g,1),d.opt.defaultId.splice(g,1),c(i)),b.removeClass("checked")}else{if(e.maxSelectNum&&!(i.length<e.maxSelectNum))return a.toast("已达上限，不能再选"),!1;i.push(f),d.opt.defaultId.push(f.id),c(i),b.addClass("checked")}}),h.on("click",".j-select",function(){e.callback(i),setTimeout(function(){a.closeModal(h)},100)})}d.$plug=h},b.prototype.addItems=function(b,c){var d=this,e="";a.each(b,function(b,f){e=f.id===d.opt.defaultId||a.inArray(f.id,d.opt.defaultId)>-1?"checked":"";var g=a('<div class="label-checkbox item-content '+e+'">'),h='<div class="item-inner"><div class="item-title-row"><div class="item-title">'+f.title+'</div></div><div class="row no-gutter"><div class="col-33"><small>持有金额</small><div class="item-subtitle">10.00</div></div><div class="col-33"><small>累计收益</small><div class="item-subtitle">5.01</div></div><div class="col-33"><small>可提金额</small><div class="item-subtitle color-primary">15.01</div></div></div><div class="item-media"><i class="icon icon-form-checkbox"></i></div>';g.html(h).data("info",f).appendTo(c)})},a.selectInvest=new b}(Zepto);