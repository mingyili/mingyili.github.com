/*!
 * Last Update : 2016-02-25 04:04:09
 */
function addcard(a,b,c){$.showPreloader(),$.ajax({type:"POST",url:API.HTTPS_HOST+"/index.php/licai/conduct/selectcard?sid="+API.sid+"&type=2",data:{orderId:a,prdtype:b,money:c,type:2},dataType:"json",complete:function(){$.hidePreloader()},success:function(a){0==a.errcode?$.router.loadPage(a.url):$.modal({text:a.errmsg,buttons:[{text:a.errbutton,onClick:function(){$.router.loadPage(a.url)}},{text:"取消"}]})}})}function changeBankAddr(){selectBankAddr=null,defaultAddrData={}}var j_addr_load=$(".j_addr_load");$(document).ready(function(){var a=$("input[name='outcardpay']:checked").val(),b=$("input[name='outcardpay']:checked").attr("rel");1==a?(data1=CASH.usercardinfo,1==data1[b].is_need_bankname?(defaultAddrData=data1[b].addr_info,defaultAddrData?($(".j-selectaddr .item-title").html(defaultAddrData.name.join(" ")),$("#id_bank_account").val(data1[b].brabank_name),$(".j_addr_load").show()):(defaultAddrData={},$(".j_addr_load").show())):(defaultAddrData={},$(".j_addr_load").hide())):(defaultAddrData={},$(".j_addr_load").hide())}),$(document).on("click",".j-daycash",function(){var a=SCASH.isPassword,b=SCASH.setPwdUrl,c=SCASH.dayCash,d=SCASH.dayCashNum,e=SCASH.sid;return 0==a?($.alert("请先设置取现密码！",function(){window.location.href=b}),!1):0>=d?($.alert("每天只有3次取现机会哦，请明天再来"),!1):100>c?($.alert("您的日利宝账户还未达到取现最低金额100元，快来投资赚钱吧！"),!1):void $.router.loadPage(API.HTTPS_HOST+"/index.php/licai/cash/cashtake?sid="+e+"&link=cashtake&type=1")}),$(document).on("click",".j-monthcash",function(){var a=SCASH.isPassword,b=SCASH.setPwdUrl,c=SCASH.investMoney,d=SCASH.sid,e=SCASH.monthCash,f=SCASH.monthCashNum;return 100>=c?($.alert("您的投资金额还未达到100元，快来投资赚钱吧"),!1):0==a?($.alert("请先设置取现密码！",function(){window.location.href=b}),!1):0>=f?($.alert("本月的取现机会已经没有了，请下月再来"),!1):e>0?void $.router.loadPage(API.HTTPS_HOST+"/index.php/licai/cash/cashselect?sid="+d+"&link=cashselect&type=2"):($.alert("您的月利宝账户还没有余额可取，快来投资赚钱吧！"),!1)});var selectBankAddr,defaultAddrData={id:["0111","0999"],name:["黑龙江","哈尔滨"]};$(document).on("click",".j-selectaddr",function(){var a=$(this);selectBankAddr||(console.log("new"),selectBankAddr=new $.selectCard(a,{defaultData:defaultAddrData,callback:function(a){defaultAddrData=a}}),selectBankAddr.open())}),window.getpayinfo=function(a){var b=CASH.orderId,c=CASH.type,d=CASH.cash,d=parseFloat($(".payMoney").val());d=d.toFixed(2),addcard(b,c,d)},window.getRadio=function(a){var a=a||window.event,b=$(a),c=CASH.usercardinfo,d=b.attr("rel");"1"==b.val()?(defaultAddrData=c[d].addr_info,defaultAddrData?($(".j-selectaddr .item-title").html(defaultAddrData.name.join(" ")),$("#id_bank_account").val(c[d].brabank_name),$(".j_addr_load").show()):(defaultAddrData={},$(".j_addr_load").show())):$(".j_addr_load").hide()};var lock=!0;$(document).on("click",".j_open_pwd",function(){var takecash=$(".j_take_cash").attr("value");$(".button-big").addClass("disabled"),$(".button-big").removeClass("j_open_pwd");var sid=CASH.sid,minCash=CASH.minCash,maxCash=CASH.maxCash,cash=CASH.cash,type=CASH.type,dayCashNum=CASH.dayCashNum,monthCashNum=CASH.monthCashNum,orderId=CASH.orderId;if(1==type){if(0>=dayCashNum)return $.alert("今天的取现机会已经没有了，请明天再来"),$(".button-big").addClass("j_open_pwd"),$(".button-big").removeClass("disabled"),!1;if(minCash>takecash&&takecash)return $.alert("最低取现金额为"+minCash+"!"),$(".j_take_cash").val(minCash),$(".button-big").addClass("j_open_pwd"),$(".button-big").removeClass("disabled"),!1;if(takecash>maxCash&&takecash)return $.alert("最大取现金额为"+maxCash+"!"),$(".button-big").addClass("j_open_pwd"),$(".button-big").removeClass("disabled"),$(".j_take_cash").val(maxCash),!1;if(!takecash)return $.alert("请输入取现金额"),$(".j_take_cash").val(minCash),$(".button-big").addClass("j_open_pwd"),$(".button-big").removeClass("disabled"),!1}else{if(2!=type)return $.alert("错误的取现类型，请重试！"),$(".button-big").addClass("j_open_pwd"),$(".button-big").removeClass("disabled"),!1;if(0>=monthCashNum)return $.alert("本月的取现机会已经没有了，请下个月再来！"),$(".button-big").addClass("j_open_pwd"),$(".button-big").removeClass("disabled"),!1;if(takecash!=cash)return $.alert("取现金额为"+cash+"!"),$(".j_take_cash").val(cash),$(".button-big").addClass("j_open_pwd"),$(".button-big").removeClass("disabled"),!1}switch(CASH.pay_type_display){case"0":var outype1=$("#to_bank").hasClass("active"),outype2=$("#to_wx").hasClass("active");if(outype1)var pay_cashtype=9,brabank_name=$("#id_bank_account").val(),bankid=$("input[name='outcardpay']:checked").attr("rel");else if(outype2)var pay_cashtype=5;break;case"5":var pay_cashtype=5;break;case"9":var pay_cashtype=9,brabank_name=$("#id_bank_account").val(),bankid=$("input[name='outcardpay']:checked").attr("rel")}if(9==pay_cashtype&&0==CASH.cardcount)return $.alert("没有银行卡，无法进行提现"),!1;var textHtml='<div class="">输入取现密码</div><div class="color-gray small">取现金额</div><div class="color-primary xbig" style="margin-top:.2rem">￥'+takecash+"</div>";$.modalPassword(textHtml,"请输入取现密码",function(pwd){return lock?pwd?(lock=!1,void $.ajax({type:"POST",url:API.HTTPS_HOST+"/index.php/licai/cash/cashtake?sid="+API.sid,data:{pwd:pwd,takecash:takecash,flag:"submitcash",type:type,order_id:orderId,pay_cashtype:pay_cashtype,pay_cashouttype:CASH.pay_type_display,bankid:bankid,brabank_name:brabank_name,addr_info:JSON.stringify(defaultAddrData)},success:function(msg){lock=!0;var data=eval("("+msg+")");if(0==data.code)$.toast("取现申请成功！",1200,"success"),setTimeout(function(){window.location.href=API.HTTPS_HOST+"/index.php/licai/activity/prepare?sid="+sid+"&outorderid="+data.insId},1e3);else{if(2!=data.code)return $.alert(data.errmsg),$(".button-big").addClass("j_open_pwd"),$(".button-big").removeClass("disabled"),!1;$(".button-big").addClass("j_open_pwd"),$(".button-big").removeClass("disabled"),$.modal({title:"密码错误！",text:data.errmsg,buttons:[{text:"重试",onClick:function(){$.closeModal()}},{text:"找回密码",onClick:function(){var a=data.url;window.location.href=a}}]})}}})):($.alert("请输入取现密码！"),$(".button-big").addClass("j_open_pwd"),$(".button-big").removeClass("disabled"),!1):(lock=!1,$.alert("提交过于频繁，请刷新后重试！"),!1)})});